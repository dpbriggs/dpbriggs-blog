var InstantClick=function(c,a){var d,n,r,o,l,s,f,u,t=navigator.userAgent,h=-1<t.indexOf(" CriOS/"),v="createTouch"in c,p={},m=!1,y=!1,b=!1,g=!1,T={},e=!1,E=!1,w=[],L={fetch:[],receive:[],wait:[],change:[]};function A(t){var e=t.indexOf("#");return e<0?t:t.substr(0,e)}function x(t){for(;t&&"A"!=t.nodeName;)t=t.parentNode;return t}function k(t){var e=a.protocol+"//"+a.host;return!(t.target||t.hasAttribute("download")||0!=t.href.indexOf(e+"/")||-1<t.href.indexOf("#")&&A(t.href)==d||(s?!function(t){do{if(!t.hasAttribute)break;if(t.hasAttribute("data-no-instant"))return!1;if(t.hasAttribute("data-instant"))return!0}while(t=t.parentNode);return!1}(t):function(t){do{if(!t.hasAttribute)break;if(t.hasAttribute("data-instant"))return!1;if(t.hasAttribute("data-no-instant"))return!0}while(t=t.parentNode);return!1}(t)))}function C(t,e,n,i){for(var r=!1,a=0;a<L[t].length;a++)if("receive"==t){var o=L[t][a](e,n,i);o&&("body"in o&&(n=o.body),"title"in o&&(i=o.title),r=o)}else L[t][a](e,n,i);return r}function M(t,e,n,i){if(c.documentElement.replaceChild(e,c.body),n){history.pushState(null,null,n);var r=n.indexOf("#"),a=-1<r&&c.getElementById(n.substr(r+1)),o=0;if(a)for(;a.offsetParent;)o+=a.offsetTop,a=a.offsetParent;scrollTo(0,o),d=A(n)}else scrollTo(0,i);h&&c.title==t?c.title=t+String.fromCharCode(160):c.title=t,I(),K.done(),C("change",!1);var s=c.createEvent("HTMLEvents");s.initEvent("instantclick:newpage",!0,!0),dispatchEvent(s)}function O(){E=e=!1}function H(t){if(!(o>+new Date-500)){var e=x(t.target);e&&k(e)&&z(e.href)}}function Y(t){if(!(o>+new Date-500)){var e=x(t.target);e&&k(e)&&(e.addEventListener("mouseout",N),u?(n=e.href,r=setTimeout(z,u)):z(e.href))}}function D(t){o=+new Date;var e=x(t.target);e&&k(e)&&(f?e.removeEventListener("mousedown",H):e.removeEventListener("mouseover",Y),z(e.href))}function B(t){var e=x(t.target);e&&k(e)&&(1<t.which||t.metaKey||t.ctrlKey||(t.preventDefault(),W(e.href)))}function N(){if(r)return clearTimeout(r),void(r=!1);e&&!E&&(l.abort(),O())}function S(){if(!(l.readyState<4)&&0!=l.status){if(T.ready=+new Date-T.start,l.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=c.implementation.createHTMLDocument("");t.documentElement.innerHTML=l.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),y=t.title,g=t.body;var e=C("receive",m,g,y);e&&("body"in e&&(g=e.body),"title"in e&&(y=e.title));var n=A(m);p[n]={body:g,title:y,scrollY:n in p?p[n].scrollY:0};for(var i,r,a=t.head.children,o=0,s=a.length-1;0<=s;s--)if((i=a[s]).hasAttribute("data-instant-track")){r=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML;for(var d=w.length-1;0<=d;d--)w[d]==r&&o++}o!=w.length&&(b=!0)}else b=!0;E&&(E=!1,W(m))}}function I(t){if(c.body.addEventListener("touchstart",D,!0),f?c.body.addEventListener("mousedown",H,!0):c.body.addEventListener("mouseover",Y,!0),c.body.addEventListener("click",B,!0),!t){var e,n,r,a,o=c.body.getElementsByTagName("script");for(i=0,j=o.length;i<j;i++)(e=o[i]).hasAttribute("data-no-instant")||(n=c.createElement("script"),e.src&&(n.src=e.src),e.innerHTML&&(n.innerHTML=e.innerHTML),r=e.parentNode,a=e.nextSibling,r.removeChild(e),r.insertBefore(n,a))}}function z(t){!f&&"display"in T&&+new Date-(T.start+T.display)<100||(r&&(clearTimeout(r),r=!1),t||(t=n),e&&(t==m||E)||(m=t,b=g=E=!(e=!0),T={start:+new Date},C("fetch"),l.open("GET",t),l.send()))}function W(t){if("display"in T||(T.display=+new Date-T.start),r||!e)return r&&m&&m!=t?void(a.href=t):(z(t),K.start(0,!0),C("wait"),void(E=!0));if(E)a.href=t;else if(b)a.href=m;else{if(!g)return K.start(0,!0),C("wait"),void(E=!0);p[d].scrollY=pageYOffset,O(),M(y,g,m)}}var K=function(){var r,a,o,n,i;function e(t,e){n=t,c.getElementById(r.id)&&c.body.removeChild(r),r.style.opacity="1",c.getElementById(r.id)&&c.body.removeChild(r),l(),e&&setTimeout(s,0),clearTimeout(i),i=setTimeout(d,500)}function s(){n=10,l()}function d(){98<=(n+=1+2*Math.random())?n=98:i=setTimeout(d,500),l()}function l(){a.style[o]="translate("+n+"%)",c.getElementById(r.id)||c.body.appendChild(r)}function f(){r.style.left=pageXOffset+"px",r.style.width=innerWidth+"px",r.style.top=pageYOffset+"px";var t="orientation"in window&&90==Math.abs(orientation),e=innerWidth/screen[t?"height":"width"]*2;r.style[o]="scaleY("+e+")"}return{init:function(){(r=c.createElement("div")).id="instantclick",(a=c.createElement("div")).id="instantclick-bar",a.className="instantclick-bar",r.appendChild(a);var t=["Webkit","Moz","O"];if(!((o="transform")in a.style))for(var e=0;e<3;e++)t[e]+"Transform"in a.style&&(o=t[e]+"Transform");var n="transition";if(!(n in a.style))for(e=0;e<3;e++)t[e]+"Transition"in a.style&&(n="-"+t[e].toLowerCase()+"-"+n);var i=c.createElement("style");i.innerHTML="#instantclick{position:"+(v?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+n+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+n+":all .25s}",c.head.appendChild(i),v&&(f(),addEventListener("resize",f),addEventListener("scroll",f))},start:e,done:function t(){if(c.getElementById(r.id))return clearTimeout(i),n=100,l(),void(r.style.opacity="0");e(100==n?0:n),setTimeout(t,0)}}}(),P="pushState"in history&&(!t.match("Android")||t.match("Chrome/"))&&"file:"!=a.protocol;return{supported:P,init:function(){if(!d)if(P){for(var t=arguments.length-1;0<=t;t--){var e=arguments[t];!0===e?s=!0:"mousedown"==e?f=!0:"number"==typeof e&&(u=e)}d=A(a.href),p[d]={body:c.body,title:c.title,scrollY:pageYOffset};var n,i,r=c.head.children;for(t=r.length-1;0<=t;t--)(n=r[t]).hasAttribute("data-instant-track")&&(i=n.getAttribute("href")||n.getAttribute("src")||n.innerHTML,w.push(i));(l=new XMLHttpRequest).addEventListener("readystatechange",S),I(!0),K.init(),C("change",!0),addEventListener("popstate",function(){var t=A(a.href);t!=d&&(t in p?(p[d].scrollY=pageYOffset,M(p[d=t].title,p[t].body,!1,p[t].scrollY)):a.href=a.href)})}else C("change",!0)},on:function(t,e){L[t].push(e)}}}(document,location);